# 카카오 웹툰 API 발견 전략

## API를 찾으려는 이유

### 1. 효율성과 안정성
- **직접 API 호출**: HTML 파싱보다 빠르고 안정적
- **데이터 구조 명확**: JSON 응답은 구조화되어 있어 파싱이 쉬움
- **네이버 웹툰 사례**: 네이버는 API 엔드포인트가 있어서 직접 호출 가능

### 2. HTML 파싱의 한계
- **구조 변경에 취약**: HTML 구조가 바뀌면 파싱 로직 수정 필요
- **복잡한 선택자**: CSS 선택자가 복잡하고 변경될 수 있음
- **동적 콘텐츠**: JavaScript로 렌더링되는 경우 Selenium 필요

### 3. 데이터 수집의 안정성
- **API는 계약(Contract)**: API는 일정한 구조를 유지하려는 경향
- **HTML은 UI 변경에 민감**: 디자인 변경 시 HTML 구조도 변경됨

## Server Side Rendering (SSR)과 API의 관계

### SSR이어도 API가 있을 수 있습니다

#### 1. 서버에서 API를 호출하는 경우
```
사용자 요청 → Next.js 서버 → 내부 API 호출 → HTML 생성 → 클라이언트
```
- 서버가 내부적으로 API를 호출해서 데이터를 가져옴
- 이 경우 클라이언트에서 직접 호출할 수 있는 공개 API가 있을 수도 있음
- 또는 서버 전용 API일 수도 있음

#### 2. 클라이언트에서도 API를 호출하는 경우
```
초기 로드: SSR로 HTML 제공
상호작용: 클라이언트에서 API 호출 (요일 변경, 필터 변경 등)
```
- Next.js는 하이브리드 렌더링을 지원
- 초기 로드는 SSR, 이후 상호작용은 클라이언트에서 API 호출

#### 3. HTML에 데이터가 포함된 경우
```html
<script id="__NEXT_DATA__" type="application/json">
  {
    "props": {
      "pageProps": {
        "webtoons": [...]
      }
    }
  }
</script>
```
- Next.js는 `__NEXT_DATA__` 스크립트 태그에 초기 데이터를 포함
- 이 경우 별도 API 호출 없이 HTML에서 데이터 추출 가능

## 카카오 웹툰의 경우

### 관찰된 사실
1. **Next.js 사용**: `_next/static/` 경로로 확인
2. **클라이언트 사이드 라우팅**: `?tab=mon`, `?tab=tue` 같은 쿼리 파라미터
3. **JavaScript 기반 상호작용**: 버튼 클릭으로 동적 콘텐츠 변경

### 가능한 시나리오

#### 시나리오 1: 클라이언트에서 API 호출
- 요일/필터 변경 시 JavaScript가 API를 호출
- **발견 방법**: Network 탭에서 XHR/Fetch 요청 확인
- **우리 스크립트**: 이미 네트워크 요청을 모니터링했지만 공개 API를 찾지 못함

#### 시나리오 2: HTML에 데이터 포함 (SSR)
- 초기 로드 시 HTML에 모든 데이터 포함
- 상호작용 시 클라이언트에서 필터링/정렬
- **발견 방법**: HTML에서 `__NEXT_DATA__` 또는 다른 JSON 데이터 찾기
- **우리 스크립트**: `page_source_full.html` 확인 필요

#### 시나리오 3: 숨겨진 API 엔드포인트
- 인증이 필요하거나 특정 헤더가 필요한 API
- GraphQL 또는 다른 형태의 API
- **발견 방법**: JavaScript 번들 분석, 브라우저 개발자 도구에서 실제 요청 확인

## 우리의 전략

### 1단계: HTML에서 데이터 확인 (가장 쉬움)
```python
# HTML에서 __NEXT_DATA__ 스크립트 태그 찾기
# 또는 다른 JSON 데이터 포함 여부 확인
```

### 2단계: 실제 브라우저에서 네트워크 요청 확인
- 헤드리스 모드가 아닌 일반 브라우저에서 확인
- 개발자 도구 Network 탭에서 실제 API 호출 확인

### 3단계: JavaScript 번들 분석
- Next.js 번들 파일에서 API 엔드포인트 패턴 찾기
- GraphQL 쿼리 또는 REST API 호출 패턴 찾기

### 4단계: HTML 파싱 (최후의 수단)
- API를 찾지 못하면 HTML 파싱으로 진행
- 네이버 웹툰처럼 HTML 파싱 로직 구현

## 결론

**SSR이어도 API를 찾을 수 있습니다:**
- 서버가 사용하는 내부 API가 클라이언트에서도 접근 가능할 수 있음
- 또는 HTML에 포함된 데이터를 추출할 수 있음

**하지만 API를 찾지 못해도 문제없습니다:**
- HTML 파싱으로도 충분히 데이터 수집 가능
- 네이버 웹툰도 HTML 파싱을 사용하고 있음

**우리의 목표:**
- 가능하면 API를 찾아서 더 안정적인 수집
- API를 찾지 못하면 HTML 파싱으로 진행

